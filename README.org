#+TITLE: Chinese Zodiac Time for Emacs

* Introduction

This library renders times via emoji / Chinese characters of the
zodiac animals, primarily for displaying the current time on the Emacs
mode-line.

It's a toy, not a serious calendar implementationâ€”if that wasn't clear
from the cartoon animals. ğŸ¦

* Background

The method used to indicate the time is loosely based on [[https://en.wikipedia.org/wiki/Traditional_Chinese_timekeeping#Eastern_Han_to_Ming_system][a system used
to measure time in the Ming dynasty]] which divided the day into 12
equal periods (æ™‚), named after the 12 earthly branches (åœ°æ”¯).
Because the animals of the Chinese zodiac map 1-to-1 with the earthly
branches, it is equally possible to indicate the time with the animals
(though I'm not suggesting this was traditionally done):

| Branch   | Animal | _Time 1_ (hh) | Time 2 (hh) |
|----------+--------+---------------+-------------|
| å­ (zÇ)   | rat    | 23â€“01         | 00â€“02       |
| ä¸‘ (chÇ’u) | ox     | 01â€“03         | 02â€“04       |
| å¯… (yÃ­n)  | tiger  | 03â€“05         | 04â€“06       |
| å¯ (mÇo)  | hare   | 05â€“07         | 06â€“08       |
| è¾° (chÃ©n) | dragon | 07â€“09         | 08â€“10       |
| å·³ (sÃ¬)   | snake  | 09â€“11         | 10â€“12       |
| åˆ (wÇ”)   | horse  | 11â€“13         | 12â€“14       |
| æœª (wÃ¨i)  | sheep  | 13â€“15         | 14â€“16       |
| ç”³ (shÄ“n) | monkey | 15â€“17         | 16â€“18       |
| é…‰ (yÇ’u)  | cock   | 17â€“19         | 18â€“20       |
| æˆŒ (xÅ«)   | dog    | 19â€“21         | 20â€“22       |
| äº¥ (hÃ i)  | pig    | 21â€“23         | 22â€“00       |

#+begin_quote
Time 1: used in ancient China until the Tang dynasty, and in ancient /
medieval Japan.

Time 2: used in the Song dynasty of China.

(Table adapted from [[https://academic.oup.com/pasj/article/56/5/887/2948928#85715189][Units of Time in Ancient China and Japan by Mitsuru SÃ´ma, /et. al./]].)
#+end_quote

This library uses the older _Time 1_ system.  Notice that the first æ™‚
/spans/ midnight.

Given that each ancient æ™‚ corresponds to /two/ of our modern hours,
it's convenient for us to know whether we're in the first or second
half of that period for alignment with our own system of timekeeping.

Indeed, by the end of the Tang dynasty, there was already such a
convention, appending either ã€Œåˆã€ or ã€Œæ­£ã€ to mark the first or
second halves, respectively, of the time period.  For example, ã€Œå­åˆã€
indicated the period from 23-00, and ã€Œå­æ­£ã€indicated 00-01.

While I have used that convention in this library with the earthly
branches, I was uncertain how well it would read when paired with the
animals of the zodiac (perhaps a native speaker can weigh in with an
opinion here).  I considered a few different options and ultimately
settled on prefixing ã€Œå°ã€ and ã€Œå¤§ã€(small and large) to
differentiate the animal-named periods, which I find quite charming:

| Time | 'cute | 'traditional | 'branches |
|------+-------+--------------+-----------|
| 3:00 | å°ğŸ¯  | å°è™          | å¯…åˆ       |
| 4:00 | å¤§ğŸ¯  | å¤§è™          | å¯…æ­£       |

If you'd prefer a different method, it is trivial to choose your own
strings for both the æ™‚ and for differentiating their halves (or not).

* Basic Usage

The simplest way to use the library is by calling ~cn-zodiac-time~,
which renders the current time according to predefined styles.

The following two invocations are equivalent:

#+begin_src emacs-lisp :exports both :results verbatim
  (cn-zodiac-time)
  (cn-zodiac-time 'cute)
#+end_src

#+RESULTS:
: "å¤§ğŸ¶ äºŒåå…«åˆ†"

** Formatting Styles

The full set of possible styles is:

#+begin_src emacs-lisp :exports results :results table
  (let ((styles '((cute        "Animal face emoji (where available)")
                  (emoji       "Animal emoji")
                  (traditional "Animal names in traditional characters")
                  (simplified  "Animal names in simplified characters")
                  (branches    "Earthly stems")))
        (time (encode-time (list 0 42 8 10 11 2024))))
    (mapcar (lambda (s)
              (list (first s) (cn-zodiac-time (first s) nil time) (second s)))
            styles))
#+end_src

#+RESULTS:
| cute        | å¤§ğŸ² å››åäºŒåˆ† | Animal face emoji (where available)    |
| emoji       | å¤§ğŸ‰ å››åäºŒåˆ† | Animals emoji                          |
| traditional | å¤§é¾ å››åäºŒåˆ† | Animal names in traditional characters |
| simplified  | å¤§é¾™ å››åäºŒåˆ† | Animal names in simplified characters  |
| branches    | è¾°æ­£ å››åäºŒåˆ† | Earthly stems                          |

** Displaying on the Mode Line

You can add the current formatted time to the mode line with:

#+begin_src emacs-lisp
  (setq display-time-string-forms '((cn-zodiac-time 'cute)))
#+end_src

(Note the embedded style symbol.)

The mode line may not immediately update.  To force an update, call:

#+begin_src emacs-lisp
  (display-time-update)
#+end_src

If you'd like to make the mode line larger, you can use:

#+begin_src emacs-lisp
  (set-face-attribute 'mode-line nil :height 200)
#+end_src

** Advanced Formatting

If you'd like more control of the formatting, you can use
~cn-zodiac-format-time~ and provide your own set of (12) 2-hour (æ™‚)
indicators, and well as the indicators to differentiate the first and
seconds halves of the hour.

* Status

Not very mature but appears to be working.

* Installation

Download =cn-zodiac-time.el= to a directory on your Emacs =load-path=
and call ~(require 'cn-zodiac-time)~.

Alternately, put it anywhere and call ~(load-file
"/your/path/cn-zodiac-time.el")~.

* Documentation

You're looking at it.

* Testing

This project does not currently have a test suite.

* Contributing

GitHub issues and PRs are welcome.  As a silly project, I may not
process these things quickly, but I'll get to them eventually.

* License

Copyright Â© Cameron Desautels, 2024

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or (at
your option) any later version.

This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see https://www.gnu.org/licenses/.

